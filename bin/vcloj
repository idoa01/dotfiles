#!/bin/bash
port=8000
printf "Leading REPL on port $port"
tmux new-session -d 'vim project.clj'
tmux split-window -p 33 -v "LEIN_REPL_PORT=$port lein repl"
while ! nc -z localhost $port; do printf "."; sleep 1; done
echo
tmux select-pane -t0
tmux send-keys ":NERDTreeToggle" C-m
tmux send-keys ":FireplaceConnect nrepl://localhost:$port" C-m C-m
tmux select-pane -t1
tmux split-window -h
tmux -2 attach-session -d
